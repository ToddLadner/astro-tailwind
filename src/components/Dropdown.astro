---
import { Icon } from 'astro-icon/components';
import type { HTMLAttributes } from 'astro/types';

interface Props extends HTMLAttributes<"dialog"> {
  id: string;
  labelledBy?: string;
  icon?: string;
  theme?: "outlined" | "tonal" | "filled" | "elevated";
  classes?: string;
}

const {
  id,
  labelledBy,
  theme,
  classes = '',
  ...rest
} = Astro.props;
---

<style>
  /* Popover styling â€” feel free to merge with your [popover] rules */
  .wrapper {
    position: relative;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15));
  }
  dialog[popover] {
    padding: var(--spacing-sm);
    background: var(--color-surface-1);
    border: 1px solid var(--color-border-2);
    border-radius: var(--radius-md);
    
    margin-inline: 0;
  }

  ul[role="list"] {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  [role="menuitem"] {
    background: none;
    border: none;
    padding: var(--spacing-2xs) var(--spacing-xs);
    width: 100%;
    text-align: left;
    font: inherit;
    cursor: pointer;
  }

  [role="menuitem"]:focus {
    outline: 2px solid var(--color-focus);
    background: var(--color-surface-hover);
  }

  /* Simple separator example */
  [role="menuitem"] + [role="menuitem"] {
    margin-top: 0.25rem;
  }
  /*  */
dialog[popover]{
  /* triangle dimension */
  --b: 1em; /* base */
  --h: .5em; /* height */

  --p: 50%; /* triangle position (0%:left 100%:right) */
  --r: var(--radius-lg); /* the radius */
  --c: var(--color-surface-1); /* the color */

  padding: var(--spacing-xs);
  text-align: center;
  border-radius: min(var(--r),var(--p) - var(--b)/2) min(var(--r),100% - var(--p) - var(--b)/2) var(--r) var(--r)/var(--r);
  clip-path: polygon(0 0,0 100%,100% 100%,100% 0, min(100%,var(--p) + var(--b)/2) 0,
    var(--p) calc(-1*var(--h)),
    max(0%, var(--p) - var(--b)/2) 0);
  background: var(--c);
  border-image: conic-gradient(var(--c) 0 0) fill 0/
    0 calc(100% - var(--p) - var(--b)/2) var(--r) calc(var(--p) - var(--b)/2)/
    var(--h) 0 0 0;
}
</style>

<!-- [2] The popover container -->
 <div class="wrapper">
<dialog
  popover
  id={id}
  role="menu"
  aria-labelledby={labelledBy}
  class:list={[theme, classes]}
  {...rest}
  tabindex="-1"
>
  <slot />
</dialog></div> 

