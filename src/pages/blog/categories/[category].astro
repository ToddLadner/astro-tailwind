---
import BlogLayout from '../../../layouts/BlogLayout.astro';
import { getCollection } from 'astro:content';
const { params } = Astro;
const posts = await getCollection('blog');
const filtered = posts.filter(p => p.data.category.toLowerCase() === params.category.toLowerCase());

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  const categories = Array.from(new Set(posts.map(p => p.data.category)));
  return categories.map(category => ({ params: { category: category.toLowerCase() } }));
}
---

<BlogLayout title={`Category: ${params.category}`} description={`Posts in ${params.category}`}>
  <h1>Category: {params.category}</h1>
  <ul>
    {filtered.map(post => (
      <li><a href={`../${post.slug}/`}>{post.data.title}</a></li>
    ))}
  </ul>
</BlogLayout>
